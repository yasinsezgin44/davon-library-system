(function(p,$){typeof exports=="object"&&typeof module<"u"?$(exports):typeof define=="function"&&define.amd?define(["exports"],$):(p=typeof globalThis<"u"?globalThis:p||self,$(p.FakeRest={}))})(this,function(p){"use strict";var th=Object.defineProperty;var rh=(p,$,O)=>$ in p?th(p,$,{enumerable:!0,configurable:!0,writable:!0,value:O}):p[$]=O;var y=(p,$,O)=>rh(p,typeof $!="symbol"?$+"":$,O);var $=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function O(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Jt=Array.isArray,S=Jt,Qt=typeof $=="object"&&$&&$.Object===Object&&$,Se=Qt,Wt=Se,Yt=typeof self=="object"&&self&&self.Object===Object&&self,Xt=Wt||Yt||Function("return this")(),T=Xt,Zt=T,kt=Zt.Symbol,D=kt,Ce=D,je=Object.prototype,er=je.hasOwnProperty,tr=je.toString,F=Ce?Ce.toStringTag:void 0;function rr(t){var e=er.call(t,F),r=t[F];try{t[F]=void 0;var a=!0}catch{}var n=tr.call(t);return a&&(e?t[F]=r:delete t[F]),n}var ar=rr,nr=Object.prototype,sr=nr.toString;function ir(t){return sr.call(t)}var or=ir,Ee=D,cr=ar,lr=or,ur="[object Null]",fr="[object Undefined]",Ie=Ee?Ee.toStringTag:void 0;function dr(t){return t==null?t===void 0?fr:ur:Ie&&Ie in Object(t)?cr(t):lr(t)}var B=dr;function hr(t){return t!=null&&typeof t=="object"}var C=hr,gr=B,pr=C,yr="[object Symbol]";function br(t){return typeof t=="symbol"||pr(t)&&gr(t)==yr}var re=br,vr=S,$r=re,_r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mr=/^\w*$/;function Ar(t,e){if(vr(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||$r(t)?!0:mr.test(t)||!_r.test(t)||e!=null&&t in Object(e)}var wr=Ar;function Tr(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var P=Tr,Or=B,Sr=P,Cr="[object AsyncFunction]",jr="[object Function]",Er="[object GeneratorFunction]",Ir="[object Proxy]";function Pr(t){if(!Sr(t))return!1;var e=Or(t);return e==jr||e==Er||e==Cr||e==Ir}var Pe=Pr,xr=T,Mr=xr["__core-js_shared__"],Nr=Mr,ae=Nr,xe=function(){var t=/[^.]+$/.exec(ae&&ae.keys&&ae.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Lr(t){return!!xe&&xe in t}var Rr=Lr,Dr=Function.prototype,Fr=Dr.toString;function Br(t){if(t!=null){try{return Fr.call(t)}catch{}try{return t+""}catch{}}return""}var Me=Br,Ur=Pe,Gr=Rr,Kr=P,Hr=Me,qr=/[\\^$.*+?()[\]{}|]/g,zr=/^\[object .+?Constructor\]$/,Vr=Function.prototype,Jr=Object.prototype,Qr=Vr.toString,Wr=Jr.hasOwnProperty,Yr=RegExp("^"+Qr.call(Wr).replace(qr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Xr(t){if(!Kr(t)||Gr(t))return!1;var e=Ur(t)?Yr:zr;return e.test(Hr(t))}var Zr=Xr;function kr(t,e){return t==null?void 0:t[e]}var ea=kr,ta=Zr,ra=ea;function aa(t,e){var r=ra(t,e);return ta(r)?r:void 0}var j=aa,na=j,sa=na(Object,"create"),U=sa,Ne=U;function ia(){this.__data__=Ne?Ne(null):{},this.size=0}var oa=ia;function ca(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var la=ca,ua=U,fa="__lodash_hash_undefined__",da=Object.prototype,ha=da.hasOwnProperty;function ga(t){var e=this.__data__;if(ua){var r=e[t];return r===fa?void 0:r}return ha.call(e,t)?e[t]:void 0}var pa=ga,ya=U,ba=Object.prototype,va=ba.hasOwnProperty;function $a(t){var e=this.__data__;return ya?e[t]!==void 0:va.call(e,t)}var _a=$a,ma=U,Aa="__lodash_hash_undefined__";function wa(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=ma&&e===void 0?Aa:e,this}var Ta=wa,Oa=oa,Sa=la,Ca=pa,ja=_a,Ea=Ta;function x(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}x.prototype.clear=Oa,x.prototype.delete=Sa,x.prototype.get=Ca,x.prototype.has=ja,x.prototype.set=Ea;var Ia=x;function Pa(){this.__data__=[],this.size=0}var xa=Pa;function Ma(t,e){return t===e||t!==t&&e!==e}var ne=Ma,Na=ne;function La(t,e){for(var r=t.length;r--;)if(Na(t[r][0],e))return r;return-1}var G=La,Ra=G,Da=Array.prototype,Fa=Da.splice;function Ba(t){var e=this.__data__,r=Ra(e,t);if(r<0)return!1;var a=e.length-1;return r==a?e.pop():Fa.call(e,r,1),--this.size,!0}var Ua=Ba,Ga=G;function Ka(t){var e=this.__data__,r=Ga(e,t);return r<0?void 0:e[r][1]}var Ha=Ka,qa=G;function za(t){return qa(this.__data__,t)>-1}var Va=za,Ja=G;function Qa(t,e){var r=this.__data__,a=Ja(r,t);return a<0?(++this.size,r.push([t,e])):r[a][1]=e,this}var Wa=Qa,Ya=xa,Xa=Ua,Za=Ha,ka=Va,en=Wa;function M(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}M.prototype.clear=Ya,M.prototype.delete=Xa,M.prototype.get=Za,M.prototype.has=ka,M.prototype.set=en;var K=M,tn=j,rn=T,an=tn(rn,"Map"),se=an,Le=Ia,nn=K,sn=se;function on(){this.size=0,this.__data__={hash:new Le,map:new(sn||nn),string:new Le}}var cn=on;function ln(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var un=ln,fn=un;function dn(t,e){var r=t.__data__;return fn(e)?r[typeof e=="string"?"string":"hash"]:r.map}var H=dn,hn=H;function gn(t){var e=hn(this,t).delete(t);return this.size-=e?1:0,e}var pn=gn,yn=H;function bn(t){return yn(this,t).get(t)}var vn=bn,$n=H;function _n(t){return $n(this,t).has(t)}var mn=_n,An=H;function wn(t,e){var r=An(this,t),a=r.size;return r.set(t,e),this.size+=r.size==a?0:1,this}var Tn=wn,On=cn,Sn=pn,Cn=vn,jn=mn,En=Tn;function N(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}N.prototype.clear=On,N.prototype.delete=Sn,N.prototype.get=Cn,N.prototype.has=jn,N.prototype.set=En;var ie=N,Re=ie,In="Expected a function";function oe(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(In);var r=function(){var a=arguments,n=e?e.apply(this,a):a[0],s=r.cache;if(s.has(n))return s.get(n);var i=t.apply(this,a);return r.cache=s.set(n,i)||s,i};return r.cache=new(oe.Cache||Re),r}oe.Cache=Re;var Pn=oe,xn=Pn,Mn=500;function Nn(t){var e=xn(t,function(a){return r.size===Mn&&r.clear(),a}),r=e.cache;return e}var Ln=Nn,Rn=Ln,Dn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Fn=/\\(\\)?/g,Bn=Rn(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Dn,function(r,a,n,s){e.push(n?s.replace(Fn,"$1"):a||r)}),e}),Un=Bn;function Gn(t,e){for(var r=-1,a=t==null?0:t.length,n=Array(a);++r<a;)n[r]=e(t[r],r,t);return n}var Kn=Gn,De=D,Hn=Kn,qn=S,zn=re,Vn=1/0,Fe=De?De.prototype:void 0,Be=Fe?Fe.toString:void 0;function Ue(t){if(typeof t=="string")return t;if(qn(t))return Hn(t,Ue)+"";if(zn(t))return Be?Be.call(t):"";var e=t+"";return e=="0"&&1/t==-Vn?"-0":e}var Jn=Ue,Qn=Jn;function Wn(t){return t==null?"":Qn(t)}var Yn=Wn,Xn=S,Zn=wr,kn=Un,es=Yn;function ts(t,e){return Xn(t)?t:Zn(t,e)?[t]:kn(es(t))}var rs=ts,as=re,ns=1/0;function ss(t){if(typeof t=="string"||as(t))return t;var e=t+"";return e=="0"&&1/t==-ns?"-0":e}var is=ss,os=rs,cs=is;function ls(t,e){e=os(e,t);for(var r=0,a=e.length;t!=null&&r<a;)t=t[cs(e[r++])];return r&&r==a?t:void 0}var us=ls,fs=us;function ds(t,e,r){var a=t==null?void 0:fs(t,e);return a===void 0?r:a}var hs=ds;const b=O(hs);var gs=K;function ps(){this.__data__=new gs,this.size=0}var ys=ps;function bs(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var vs=bs;function $s(t){return this.__data__.get(t)}var _s=$s;function ms(t){return this.__data__.has(t)}var As=ms,ws=K,Ts=se,Os=ie,Ss=200;function Cs(t,e){var r=this.__data__;if(r instanceof ws){var a=r.__data__;if(!Ts||a.length<Ss-1)return a.push([t,e]),this.size=++r.size,this;r=this.__data__=new Os(a)}return r.set(t,e),this.size=r.size,this}var js=Cs,Es=K,Is=ys,Ps=vs,xs=_s,Ms=As,Ns=js;function L(t){var e=this.__data__=new Es(t);this.size=e.size}L.prototype.clear=Is,L.prototype.delete=Ps,L.prototype.get=xs,L.prototype.has=Ms,L.prototype.set=Ns;var ce=L;function Ls(t,e){for(var r=-1,a=t==null?0:t.length;++r<a&&e(t[r],r,t)!==!1;);return t}var Rs=Ls,Ds=j,Fs=function(){try{var t=Ds(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Bs=Fs,Ge=Bs;function Us(t,e,r){e=="__proto__"&&Ge?Ge(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var Ke=Us,Gs=Ke,Ks=ne,Hs=Object.prototype,qs=Hs.hasOwnProperty;function zs(t,e,r){var a=t[e];(!(qs.call(t,e)&&Ks(a,r))||r===void 0&&!(e in t))&&Gs(t,e,r)}var He=zs,Vs=He,Js=Ke;function Qs(t,e,r,a){var n=!r;r||(r={});for(var s=-1,i=e.length;++s<i;){var o=e[s],c=a?a(r[o],t[o],o,r,t):void 0;c===void 0&&(c=t[o]),n?Js(r,o,c):Vs(r,o,c)}return r}var q=Qs;function Ws(t,e){for(var r=-1,a=Array(t);++r<t;)a[r]=e(r);return a}var Ys=Ws,Xs=B,Zs=C,ks="[object Arguments]";function ei(t){return Zs(t)&&Xs(t)==ks}var ti=ei,qe=ti,ri=C,ze=Object.prototype,ai=ze.hasOwnProperty,ni=ze.propertyIsEnumerable,si=qe(function(){return arguments}())?qe:function(t){return ri(t)&&ai.call(t,"callee")&&!ni.call(t,"callee")},ii=si,z={exports:{}};function oi(){return!1}var ci=oi;z.exports,function(t,e){var r=T,a=ci,n=e&&!e.nodeType&&e,s=n&&!0&&t&&!t.nodeType&&t,i=s&&s.exports===n,o=i?r.Buffer:void 0,c=o?o.isBuffer:void 0,l=c||a;t.exports=l}(z,z.exports);var le=z.exports,li=9007199254740991,ui=/^(?:0|[1-9]\d*)$/;function fi(t,e){var r=typeof t;return e=e??li,!!e&&(r=="number"||r!="symbol"&&ui.test(t))&&t>-1&&t%1==0&&t<e}var di=fi,hi=9007199254740991;function gi(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=hi}var Ve=gi,pi=B,yi=Ve,bi=C,vi="[object Arguments]",$i="[object Array]",_i="[object Boolean]",mi="[object Date]",Ai="[object Error]",wi="[object Function]",Ti="[object Map]",Oi="[object Number]",Si="[object Object]",Ci="[object RegExp]",ji="[object Set]",Ei="[object String]",Ii="[object WeakMap]",Pi="[object ArrayBuffer]",xi="[object DataView]",Mi="[object Float32Array]",Ni="[object Float64Array]",Li="[object Int8Array]",Ri="[object Int16Array]",Di="[object Int32Array]",Fi="[object Uint8Array]",Bi="[object Uint8ClampedArray]",Ui="[object Uint16Array]",Gi="[object Uint32Array]",g={};g[Mi]=g[Ni]=g[Li]=g[Ri]=g[Di]=g[Fi]=g[Bi]=g[Ui]=g[Gi]=!0,g[vi]=g[$i]=g[Pi]=g[_i]=g[xi]=g[mi]=g[Ai]=g[wi]=g[Ti]=g[Oi]=g[Si]=g[Ci]=g[ji]=g[Ei]=g[Ii]=!1;function Ki(t){return bi(t)&&yi(t.length)&&!!g[pi(t)]}var Hi=Ki;function qi(t){return function(e){return t(e)}}var ue=qi,V={exports:{}};V.exports,function(t,e){var r=Se,a=e&&!e.nodeType&&e,n=a&&!0&&t&&!t.nodeType&&t,s=n&&n.exports===a,i=s&&r.process,o=function(){try{var c=n&&n.require&&n.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();t.exports=o}(V,V.exports);var fe=V.exports,zi=Hi,Vi=ue,Je=fe,Qe=Je&&Je.isTypedArray,Ji=Qe?Vi(Qe):zi,We=Ji,Qi=Ys,Wi=ii,Yi=S,Xi=le,Zi=di,ki=We,eo=Object.prototype,to=eo.hasOwnProperty;function ro(t,e){var r=Yi(t),a=!r&&Wi(t),n=!r&&!a&&Xi(t),s=!r&&!a&&!n&&ki(t),i=r||a||n||s,o=i?Qi(t.length,String):[],c=o.length;for(var l in t)(e||to.call(t,l))&&!(i&&(l=="length"||n&&(l=="offset"||l=="parent")||s&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Zi(l,c)))&&o.push(l);return o}var Ye=ro,ao=Object.prototype;function no(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||ao;return t===r}var de=no;function so(t,e){return function(r){return t(e(r))}}var Xe=so,io=Xe,oo=io(Object.keys,Object),co=oo,lo=de,uo=co,fo=Object.prototype,ho=fo.hasOwnProperty;function go(t){if(!lo(t))return uo(t);var e=[];for(var r in Object(t))ho.call(t,r)&&r!="constructor"&&e.push(r);return e}var po=go,yo=Pe,bo=Ve;function vo(t){return t!=null&&bo(t.length)&&!yo(t)}var Ze=vo,$o=Ye,_o=po,mo=Ze;function Ao(t){return mo(t)?$o(t):_o(t)}var J=Ao,wo=q,To=J;function Oo(t,e){return t&&wo(e,To(e),t)}var So=Oo;function Co(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var jo=Co,Eo=P,Io=de,Po=jo,xo=Object.prototype,Mo=xo.hasOwnProperty;function No(t){if(!Eo(t))return Po(t);var e=Io(t),r=[];for(var a in t)a=="constructor"&&(e||!Mo.call(t,a))||r.push(a);return r}var Lo=No,Ro=Ye,Do=Lo,Fo=Ze;function Bo(t){return Fo(t)?Ro(t,!0):Do(t)}var he=Bo,Uo=q,Go=he;function Ko(t,e){return t&&Uo(e,Go(e),t)}var Ho=Ko,Q={exports:{}};Q.exports,function(t,e){var r=T,a=e&&!e.nodeType&&e,n=a&&!0&&t&&!t.nodeType&&t,s=n&&n.exports===a,i=s?r.Buffer:void 0,o=i?i.allocUnsafe:void 0;function c(l,u){if(u)return l.slice();var d=l.length,h=o?o(d):new l.constructor(d);return l.copy(h),h}t.exports=c}(Q,Q.exports);var qo=Q.exports;function zo(t,e){var r=-1,a=t.length;for(e||(e=Array(a));++r<a;)e[r]=t[r];return e}var Vo=zo;function Jo(t,e){for(var r=-1,a=t==null?0:t.length,n=0,s=[];++r<a;){var i=t[r];e(i,r,t)&&(s[n++]=i)}return s}var Qo=Jo;function Wo(){return[]}var ke=Wo,Yo=Qo,Xo=ke,Zo=Object.prototype,ko=Zo.propertyIsEnumerable,et=Object.getOwnPropertySymbols,ec=et?function(t){return t==null?[]:(t=Object(t),Yo(et(t),function(e){return ko.call(t,e)}))}:Xo,ge=ec,tc=q,rc=ge;function ac(t,e){return tc(t,rc(t),e)}var nc=ac;function sc(t,e){for(var r=-1,a=e.length,n=t.length;++r<a;)t[n+r]=e[r];return t}var tt=sc,ic=Xe,oc=ic(Object.getPrototypeOf,Object),rt=oc,cc=tt,lc=rt,uc=ge,fc=ke,dc=Object.getOwnPropertySymbols,hc=dc?function(t){for(var e=[];t;)cc(e,uc(t)),t=lc(t);return e}:fc,at=hc,gc=q,pc=at;function yc(t,e){return gc(t,pc(t),e)}var bc=yc,vc=tt,$c=S;function _c(t,e,r){var a=e(t);return $c(t)?a:vc(a,r(t))}var nt=_c,mc=nt,Ac=ge,wc=J;function Tc(t){return mc(t,wc,Ac)}var st=Tc,Oc=nt,Sc=at,Cc=he;function jc(t){return Oc(t,Cc,Sc)}var Ec=jc,Ic=j,Pc=T,xc=Ic(Pc,"DataView"),Mc=xc,Nc=j,Lc=T,Rc=Nc(Lc,"Promise"),Dc=Rc,Fc=j,Bc=T,Uc=Fc(Bc,"Set"),Gc=Uc,Kc=j,Hc=T,qc=Kc(Hc,"WeakMap"),zc=qc,pe=Mc,ye=se,be=Dc,ve=Gc,$e=zc,it=B,R=Me,ot="[object Map]",Vc="[object Object]",ct="[object Promise]",lt="[object Set]",ut="[object WeakMap]",ft="[object DataView]",Jc=R(pe),Qc=R(ye),Wc=R(be),Yc=R(ve),Xc=R($e),E=it;(pe&&E(new pe(new ArrayBuffer(1)))!=ft||ye&&E(new ye)!=ot||be&&E(be.resolve())!=ct||ve&&E(new ve)!=lt||$e&&E(new $e)!=ut)&&(E=function(t){var e=it(t),r=e==Vc?t.constructor:void 0,a=r?R(r):"";if(a)switch(a){case Jc:return ft;case Qc:return ot;case Wc:return ct;case Yc:return lt;case Xc:return ut}return e});var W=E,Zc=Object.prototype,kc=Zc.hasOwnProperty;function el(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&kc.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var tl=el,rl=T,al=rl.Uint8Array,dt=al,ht=dt;function nl(t){var e=new t.constructor(t.byteLength);return new ht(e).set(new ht(t)),e}var _e=nl,sl=_e;function il(t,e){var r=e?sl(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var ol=il,cl=/\w*$/;function ll(t){var e=new t.constructor(t.source,cl.exec(t));return e.lastIndex=t.lastIndex,e}var ul=ll,gt=D,pt=gt?gt.prototype:void 0,yt=pt?pt.valueOf:void 0;function fl(t){return yt?Object(yt.call(t)):{}}var dl=fl,hl=_e;function gl(t,e){var r=e?hl(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var pl=gl,yl=_e,bl=ol,vl=ul,$l=dl,_l=pl,ml="[object Boolean]",Al="[object Date]",wl="[object Map]",Tl="[object Number]",Ol="[object RegExp]",Sl="[object Set]",Cl="[object String]",jl="[object Symbol]",El="[object ArrayBuffer]",Il="[object DataView]",Pl="[object Float32Array]",xl="[object Float64Array]",Ml="[object Int8Array]",Nl="[object Int16Array]",Ll="[object Int32Array]",Rl="[object Uint8Array]",Dl="[object Uint8ClampedArray]",Fl="[object Uint16Array]",Bl="[object Uint32Array]";function Ul(t,e,r){var a=t.constructor;switch(e){case El:return yl(t);case ml:case Al:return new a(+t);case Il:return bl(t,r);case Pl:case xl:case Ml:case Nl:case Ll:case Rl:case Dl:case Fl:case Bl:return _l(t,r);case wl:return new a;case Tl:case Cl:return new a(t);case Ol:return vl(t);case Sl:return new a;case jl:return $l(t)}}var Gl=Ul,Kl=P,bt=Object.create,Hl=function(){function t(){}return function(e){if(!Kl(e))return{};if(bt)return bt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),ql=Hl,zl=ql,Vl=rt,Jl=de;function Ql(t){return typeof t.constructor=="function"&&!Jl(t)?zl(Vl(t)):{}}var Wl=Ql,Yl=W,Xl=C,Zl="[object Map]";function kl(t){return Xl(t)&&Yl(t)==Zl}var eu=kl,tu=eu,ru=ue,vt=fe,$t=vt&&vt.isMap,au=$t?ru($t):tu,nu=au,su=W,iu=C,ou="[object Set]";function cu(t){return iu(t)&&su(t)==ou}var lu=cu,uu=lu,fu=ue,_t=fe,mt=_t&&_t.isSet,du=mt?fu(mt):uu,hu=du,gu=ce,pu=Rs,yu=He,bu=So,vu=Ho,$u=qo,_u=Vo,mu=nc,Au=bc,wu=st,Tu=Ec,Ou=W,Su=tl,Cu=Gl,ju=Wl,Eu=S,Iu=le,Pu=nu,xu=P,Mu=hu,Nu=J,Lu=he,Ru=1,Du=2,Fu=4,At="[object Arguments]",Bu="[object Array]",Uu="[object Boolean]",Gu="[object Date]",Ku="[object Error]",wt="[object Function]",Hu="[object GeneratorFunction]",qu="[object Map]",zu="[object Number]",Tt="[object Object]",Vu="[object RegExp]",Ju="[object Set]",Qu="[object String]",Wu="[object Symbol]",Yu="[object WeakMap]",Xu="[object ArrayBuffer]",Zu="[object DataView]",ku="[object Float32Array]",ef="[object Float64Array]",tf="[object Int8Array]",rf="[object Int16Array]",af="[object Int32Array]",nf="[object Uint8Array]",sf="[object Uint8ClampedArray]",of="[object Uint16Array]",cf="[object Uint32Array]",f={};f[At]=f[Bu]=f[Xu]=f[Zu]=f[Uu]=f[Gu]=f[ku]=f[ef]=f[tf]=f[rf]=f[af]=f[qu]=f[zu]=f[Tt]=f[Vu]=f[Ju]=f[Qu]=f[Wu]=f[nf]=f[sf]=f[of]=f[cf]=!0,f[Ku]=f[wt]=f[Yu]=!1;function Y(t,e,r,a,n,s){var i,o=e&Ru,c=e&Du,l=e&Fu;if(r&&(i=n?r(t,a,n,s):r(t)),i!==void 0)return i;if(!xu(t))return t;var u=Eu(t);if(u){if(i=Su(t),!o)return _u(t,i)}else{var d=Ou(t),h=d==wt||d==Hu;if(Iu(t))return $u(t,o);if(d==Tt||d==At||h&&!n){if(i=c||h?{}:ju(t),!o)return c?Au(t,vu(i,t)):mu(t,bu(i,t))}else{if(!f[d])return n?t:{};i=Cu(t,d,o)}}s||(s=new gu);var w=s.get(t);if(w)return w;s.set(t,i),Mu(t)?t.forEach(function(v){i.add(Y(v,e,r,v,t,s))}):Pu(t)&&t.forEach(function(v,_){i.set(_,Y(v,e,r,_,t,s))});var m=l?c?Tu:wu:c?Lu:Nu,A=u?void 0:m(t);return pu(A||t,function(v,_){A&&(_=v,v=t[_]),yu(i,_,Y(v,e,r,_,t,s))}),i}var Ot=Y,lf="__lodash_hash_undefined__";function uf(t){return this.__data__.set(t,lf),this}var ff=uf;function df(t){return this.__data__.has(t)}var hf=df,gf=ie,pf=ff,yf=hf;function X(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new gf;++e<r;)this.add(t[e])}X.prototype.add=X.prototype.push=pf,X.prototype.has=yf;var bf=X;function vf(t,e){for(var r=-1,a=t==null?0:t.length;++r<a;)if(e(t[r],r,t))return!0;return!1}var $f=vf;function _f(t,e){return t.has(e)}var mf=_f,Af=bf,wf=$f,Tf=mf,Of=1,Sf=2;function Cf(t,e,r,a,n,s){var i=r&Of,o=t.length,c=e.length;if(o!=c&&!(i&&c>o))return!1;var l=s.get(t),u=s.get(e);if(l&&u)return l==e&&u==t;var d=-1,h=!0,w=r&Sf?new Af:void 0;for(s.set(t,e),s.set(e,t);++d<o;){var m=t[d],A=e[d];if(a)var v=i?a(A,m,d,e,t,s):a(m,A,d,t,e,s);if(v!==void 0){if(v)continue;h=!1;break}if(w){if(!wf(e,function(_,I){if(!Tf(w,I)&&(m===_||n(m,_,r,a,s)))return w.push(I)})){h=!1;break}}else if(!(m===A||n(m,A,r,a,s))){h=!1;break}}return s.delete(t),s.delete(e),h}var St=Cf;function jf(t){var e=-1,r=Array(t.size);return t.forEach(function(a,n){r[++e]=[n,a]}),r}var Ef=jf;function If(t){var e=-1,r=Array(t.size);return t.forEach(function(a){r[++e]=a}),r}var Pf=If,Ct=D,jt=dt,xf=ne,Mf=St,Nf=Ef,Lf=Pf,Rf=1,Df=2,Ff="[object Boolean]",Bf="[object Date]",Uf="[object Error]",Gf="[object Map]",Kf="[object Number]",Hf="[object RegExp]",qf="[object Set]",zf="[object String]",Vf="[object Symbol]",Jf="[object ArrayBuffer]",Qf="[object DataView]",Et=Ct?Ct.prototype:void 0,me=Et?Et.valueOf:void 0;function Wf(t,e,r,a,n,s,i){switch(r){case Qf:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Jf:return!(t.byteLength!=e.byteLength||!s(new jt(t),new jt(e)));case Ff:case Bf:case Kf:return xf(+t,+e);case Uf:return t.name==e.name&&t.message==e.message;case Hf:case zf:return t==e+"";case Gf:var o=Nf;case qf:var c=a&Rf;if(o||(o=Lf),t.size!=e.size&&!c)return!1;var l=i.get(t);if(l)return l==e;a|=Df,i.set(t,e);var u=Mf(o(t),o(e),a,n,s,i);return i.delete(t),u;case Vf:if(me)return me.call(t)==me.call(e)}return!1}var Yf=Wf,It=st,Xf=1,Zf=Object.prototype,kf=Zf.hasOwnProperty;function ed(t,e,r,a,n,s){var i=r&Xf,o=It(t),c=o.length,l=It(e),u=l.length;if(c!=u&&!i)return!1;for(var d=c;d--;){var h=o[d];if(!(i?h in e:kf.call(e,h)))return!1}var w=s.get(t),m=s.get(e);if(w&&m)return w==e&&m==t;var A=!0;s.set(t,e),s.set(e,t);for(var v=i;++d<c;){h=o[d];var _=t[h],I=e[h];if(a)var Vt=i?a(I,_,h,e,t,s):a(_,I,h,t,e,s);if(!(Vt===void 0?_===I||n(_,I,r,a,s):Vt)){A=!1;break}v||(v=h=="constructor")}if(A&&!v){var ee=t.constructor,te=e.constructor;ee!=te&&"constructor"in t&&"constructor"in e&&!(typeof ee=="function"&&ee instanceof ee&&typeof te=="function"&&te instanceof te)&&(A=!1)}return s.delete(t),s.delete(e),A}var td=ed,Ae=ce,rd=St,ad=Yf,nd=td,Pt=W,xt=S,Mt=le,sd=We,id=1,Nt="[object Arguments]",Lt="[object Array]",Z="[object Object]",od=Object.prototype,Rt=od.hasOwnProperty;function cd(t,e,r,a,n,s){var i=xt(t),o=xt(e),c=i?Lt:Pt(t),l=o?Lt:Pt(e);c=c==Nt?Z:c,l=l==Nt?Z:l;var u=c==Z,d=l==Z,h=c==l;if(h&&Mt(t)){if(!Mt(e))return!1;i=!0,u=!1}if(h&&!u)return s||(s=new Ae),i||sd(t)?rd(t,e,r,a,n,s):ad(t,e,c,r,a,n,s);if(!(r&id)){var w=u&&Rt.call(t,"__wrapped__"),m=d&&Rt.call(e,"__wrapped__");if(w||m){var A=w?t.value():t,v=m?e.value():e;return s||(s=new Ae),n(A,v,r,a,s)}}return h?(s||(s=new Ae),nd(t,e,r,a,n,s)):!1}var ld=cd,ud=ld,Dt=C;function Ft(t,e,r,a,n){return t===e?!0:t==null||e==null||!Dt(t)&&!Dt(e)?t!==t&&e!==e:ud(t,e,r,a,Ft,n)}var fd=Ft,dd=ce,hd=fd,gd=1,pd=2;function yd(t,e,r,a){var n=r.length,s=n,i=!a;if(t==null)return!s;for(t=Object(t);n--;){var o=r[n];if(i&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++n<s;){o=r[n];var c=o[0],l=t[c],u=o[1];if(i&&o[2]){if(l===void 0&&!(c in t))return!1}else{var d=new dd;if(a)var h=a(l,u,c,t,e,d);if(!(h===void 0?hd(u,l,gd|pd,a,d):h))return!1}}return!0}var bd=yd,vd=P;function $d(t){return t===t&&!vd(t)}var _d=$d,md=_d,Ad=J;function wd(t){for(var e=Ad(t),r=e.length;r--;){var a=e[r],n=t[a];e[r]=[a,n,md(n)]}return e}var Td=wd;function Od(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var Sd=Od,Cd=bd,jd=Td,Ed=Sd;function Id(t){var e=jd(t);return e.length==1&&e[0][2]?Ed(e[0][0],e[0][1]):function(r){return r===t||Cd(r,t,e)}}var Pd=Id,xd=Ot,Md=Pd,Nd=1;function Ld(t){return Md(xd(t,Nd))}var Rd=Ld;const Dd=O(Rd);var Fd=Ot,Bd=1,Ud=4;function Gd(t){return Fd(t,Bd|Ud)}var Kd=Gd;const Bt=O(Kd);class we{constructor({items:e=[],identifierName:r="id",getNewId:a}={}){y(this,"sequence",0);y(this,"items",[]);y(this,"database",null);y(this,"name",null);y(this,"identifierName","id");y(this,"getNewId");if(!Array.isArray(e))throw new Error("Can't initialize a Collection with anything else than an array of items");this.identifierName=r,this.getNewId=a||this.getNewIdFromSequence,e.map(this.addOne.bind(this))}setDatabase(e){this.database=e}setName(e){this.name=e}_oneToManyEmbedder(e){if(this.name==null)throw new Error("Can't embed references without a collection name");const a=`${this.name.slice(0,-1)}_id`;return n=>{if(this.database==null)throw new Error("Can't embed references without a database");const s=this.database.collections[e];if(!s)throw new Error(`Can't embed a non-existing collection ${e}`);return Array.isArray(n[e])?n[e]=s.getAll({filter:i=>n[e].indexOf(i[s.identifierName])!==-1}):n[e]=s.getAll({filter:i=>i[a]===n[this.identifierName]}),n}}_manyToOneEmbedder(e){const r=`${e}s`,a=`${e}_id`;return n=>{if(this.database==null)throw new Error("Can't embed references without a database");const s=this.database.collections[r];if(!s)throw new Error(`Can't embed a non-existing collection ${e}`);try{n[e]=s.getOne(n[a])}catch{}return n}}_itemEmbedder(e){const a=(Array.isArray(e)?e:[e]).map(n=>n.endsWith("s")?this._oneToManyEmbedder(n):this._manyToOneEmbedder(n));return n=>a.reduce((s,i)=>i(s),n)}getCount(e){return this.getAll(e).length}getAll(e){let r=this.items.slice(0);return e&&(e.filter&&(r=Gt(r,e.filter)),e.sort&&(r=Vd(r,e.sort)),e.range&&(r=Jd(r,e.range)),r=r.map(a=>Object.assign({},a)),e.embed&&this.database&&(r=r.map(this._itemEmbedder(e.embed)))),r}getIndex(e){return this.items.findIndex(r=>r[this.identifierName]==e)}getOne(e,r){const a=this.getIndex(e);if(a===-1)throw new Error(`No item with identifier ${e}`);let n=this.items[a];return n=Object.assign({},n),r!=null&&r.embed&&this.database&&(n=this._itemEmbedder(r.embed)(n)),n}getNewIdFromSequence(){return this.sequence++}addOne(e){const r=Bt(e),a=r[this.identifierName];if(a!=null){if(this.getIndex(a)!==-1)throw new Error(`An item with the identifier ${a} already exists`);typeof a=="number"&&(this.sequence=Math.max(this.sequence,a)+1)}else r[this.identifierName]=this.getNewId();return this.items.push(r),r}updateOne(e,r){const a=this.getIndex(e);if(a===-1)throw new Error(`No item with identifier ${e}`);for(const n in r)this.items[a][n]=r[n];return Object.assign({},this.items[a])}removeOne(e){const r=this.getIndex(e);if(r===-1)throw new Error(`No item with identifier ${e}`);const a=this.items[r];return this.items.splice(r,1),typeof e=="number"&&e==this.sequence-1&&this.sequence--,a}}const Hd=(t,e)=>t.reduce((r,a)=>r&&e(a),!0),qd=(t,e)=>t.reduce((r,a)=>r||e(a),!1),zd=(t,e)=>t.reduce((r,a,n)=>{if(r!=null)return r;const s=t.slice(0,n+1).join("."),i=t.slice(n+1).join("."),o=b(e,s);return Array.isArray(o)&&n<t.length-1?[s,i]:void 0},void 0),Ut=(t,e)=>{if(t.indexOf("_q")!==-1){const r=t.replace(/(_q)$/,""),a=new RegExp(e.toString(),"i");return n=>{var s;return((s=b(n,r))==null?void 0:s.toString().match(a))!==null}}if(t.indexOf("_lte")!==-1){const r=t.replace(/(_lte)$/,"");return a=>b(a,r)<=e}if(t.indexOf("_gte")!==-1){const r=t.replace(/(_gte)$/,"");return a=>b(a,r)>=e}if(t.indexOf("_lt")!==-1){const r=t.replace(/(_lt)$/,"");return a=>b(a,r)<e}if(t.indexOf("_gt")!==-1){const r=t.replace(/(_gt)$/,"");return a=>b(a,r)>e}if(t.indexOf("_neq_any")!==-1){const r=t.replace(/(_neq_any)$/,""),a=Array.isArray(e)?e:[e];return n=>a.every(s=>b(n,r)!=s)}if(t.indexOf("_neq")!==-1){const r=t.replace(/(_neq)$/,"");return a=>b(a,r)!=e}if(t.indexOf("_eq_any")!==-1){const r=t.replace(/(_eq_any)$/,""),a=Array.isArray(e)?e:[e];return n=>a.some(s=>b(n,r)==s)}if(t.indexOf("_eq")!==-1){const r=t.replace(/(_eq)$/,"");return a=>b(a,r)==e}if(t.indexOf("_inc_any")!==-1){const r=t.replace(/(_inc_any)$/,""),a=Array.isArray(e)?e:[e];return n=>a.some(s=>{const i=b(n,r);return Array.isArray(i)||typeof i=="string"?i.includes(s):!1})}if(t.indexOf("_inc")!==-1){const r=t.replace(/(_inc)$/,""),a=Array.isArray(e)?e:[e];return n=>a.every(s=>{const i=b(n,r);return Array.isArray(i)||typeof i=="string"?i.includes(s):!1})}if(t.indexOf("_ninc_any")!==-1){const r=t.replace(/(_ninc_any)$/,""),a=Array.isArray(e)?e:[e];return n=>a.every(s=>{const i=b(n,r);return Array.isArray(i)||typeof i=="string"?!i.includes(s):!1})}return Array.isArray(e)?r=>Array.isArray(b(r,t))?Hd(e,a=>{const n=b(r,t);return Array.isArray(n)?qd(n,s=>s==a):!1}):e.filter(a=>a==b(r,t)).length>0:typeof e=="object"?r=>Dd(e)(b(r,t)):r=>{const a=b(r,t);return Array.isArray(a)&&typeof e=="string"?a.indexOf(e)!==-1:typeof a=="boolean"&&typeof e=="string"?a===(e==="true"):a==e}};function Gt(t,e){if(typeof e=="function")return t.filter(e);if(e instanceof Object){const r=Object.keys(e).map(a=>{if(a==="q"&&typeof e.q=="string"){const i=Qd(e.q),o=c=>{for(const l in c){const u=c[l];if(typeof u=="object"&&o(u)||u&&typeof u=="string"&&u.match&&u.match(i)!==null)return!0}return!1};return o}const n=a.split("."),s=e[a];return n.length>1?i=>{const o=zd(n,i);if(o){const[c,l]=o,u=b(i,c);return Array.isArray(u)?Gt(u,{[l]:s}).length>0:!1}return Ut(a,s)(i)}:Ut(a,s)});return t.filter(a=>r.reduce((n,s)=>n&&s(a),!0))}throw new Error("Unsupported filter type")}function Vd(t,e){if(typeof e=="function")return t.sort(e);if(typeof e=="string")return t.sort((r,a)=>r[e]>a[e]?1:r[e]<a[e]?-1:0);if(Array.isArray(e)){const r=e[0],a=e[1].toLowerCase()==="asc"?1:-1;return t.sort((n,s)=>n[r]>s[r]?a:n[r]<s[r]?-1*a:0)}throw new Error("Unsupported sort type")}function Jd(t,e){if(Array.isArray(e))return t.slice(e[0],e[1]!==void 0?e[1]+1:void 0);throw new Error("Unsupported range type")}function Qd(t){const n=t.trim().replace(/[.*+?^${}()|[\]\\]/g,"\\$&").split(" ").map(i=>`(${i})`).join("|");return new RegExp(n,"i")}class Kt{constructor(e){y(this,"obj",null);y(this,"database",null);y(this,"name",null);if(!(e instanceof Object))throw new Error("Can't initialize a Single with anything except an object");this.obj=Bt(e)}setDatabase(e){this.database=e}setName(e){this.name=e}_oneToManyEmbedder(e){return r=>{if(this.database==null)throw new Error("Can't embed references without a database");const a=this.database.collections[e];if(!a)throw new Error(`Can't embed a non-existing collection ${e}`);return r[e]=a.getAll({filter:n=>r[e].indexOf(n[a.identifierName])!==-1}),r}}_manyToOneEmbedder(e){const r=`${e}s`,a=`${e}_id`;return n=>{if(this.database==null)throw new Error("Can't embed references without a database");const s=this.database.collections[r];if(!s)throw new Error(`Can't embed a non-existing collection ${e}`);try{n[e]=s.getOne(n[a])}catch{}return n}}_itemEmbedder(e){const a=(Array.isArray(e)?e:[e]).map(n=>n.endsWith("s")?this._oneToManyEmbedder(n):this._manyToOneEmbedder(n));return n=>a.reduce((s,i)=>i(s),n)}getOnly(e){let r=this.obj;return e!=null&&e.embed&&this.database&&(r=Object.assign({},r),r=this._itemEmbedder(e.embed)(r)),r}updateOnly(e){if(this.obj==null)throw new Error("Can't update a non-existing object");for(const r in e)this.obj[r]=e[r];return this.obj}}class Ht{constructor({data:e,identifierName:r="id",getNewId:a}={}){y(this,"identifierName","id");y(this,"collections",{});y(this,"singles",{});y(this,"getNewId");this.getNewId=a,this.identifierName=r,e&&this.init(e)}init(e){for(const r in e){const a=e[r];Array.isArray(a)?this.addCollection(r,new we({items:a,identifierName:this.identifierName,getNewId:this.getNewId})):this.addSingle(r,new Kt(a))}}addCollection(e,r){this.collections[e]=r,r.setDatabase(this),r.setName(e)}getCollection(e){return this.collections[e]}getCollectionNames(){return Object.keys(this.collections)}addSingle(e,r){this.singles[e]=r,r.setDatabase(this),r.setName(e)}getSingle(e){return this.singles[e]}getSingleNames(){return Object.keys(this.singles)}getCount(e,r){return this.collections[e].getCount(r)}getAll(e,r){return this.collections[e].getAll(r)}getOne(e,r,a){return this.collections[e].getOne(r,a)}addOne(e,r){return Object.prototype.hasOwnProperty.call(this.collections,e)||this.addCollection(e,new we({items:[],identifierName:this.identifierName,getNewId:this.getNewId})),this.collections[e].addOne(r)}updateOne(e,r,a){return this.collections[e].updateOne(r,a)}removeOne(e,r){return this.collections[e].removeOne(r)}getOnly(e,r){return this.singles[e].getOnly()}updateOnly(e,r){return this.singles[e].updateOnly(r)}}class k{constructor({baseUrl:e="",defaultQuery:r=()=>({}),database:a,middlewares:n,...s}={}){y(this,"baseUrl","");y(this,"defaultQuery",()=>({}));y(this,"middlewares");y(this,"database");this.baseUrl=e,this.defaultQuery=r,this.middlewares=n||[],a?this.database=a:this.database=new Ht(s)}setDefaultQuery(e){this.defaultQuery=e}getContext(e){var a,n;for(const s of this.database.getSingleNames())if((a=e.url)!=null&&a.match(new RegExp(`^${this.baseUrl}\\/(${s})(\\/?.*)?$`)))return{...e,single:s};const r=(n=e.url)==null?void 0:n.match(new RegExp(`^${this.baseUrl}\\/([^\\/?]+)(\\/(\\w+|\\d+))?(\\?.*)?$`));if(r){const s=r[1],i=Object.assign({},this.defaultQuery(s),e.params);return{...e,collection:s,params:i}}return e}async handle(e){const r=this.getContext(e);let a=0;const n=[...this.middlewares],s=i=>{const o=n[a++];return o?o(i,s):this.handleRequest(i)};try{return await s(r)}catch(i){if(i instanceof Error)throw i;return i}}handleRequest(e){var s,i;for(const o of this.database.getSingleNames())if((s=e.url)!=null&&s.match(new RegExp(`^${this.baseUrl}\\/(${o})(\\/?.*)?$`))){if(e.method==="GET")try{return{status:200,body:this.database.getOnly(o),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(e.method==="PUT")try{return e.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOnly(o,e.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(e.method==="PATCH")try{return e.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOnly(o,e.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}}const r=(i=e.url)==null?void 0:i.match(new RegExp(`^${this.baseUrl}\\/([^\\/?]+)(\\/(\\w+|\\d+))?(\\?.*)?$`));if(!r)return{status:404,headers:{}};const a=r[1],n=Object.assign({},this.defaultQuery(a),e.params);if(r[2]){if(!this.database.getCollection(a))return{status:404,headers:{}};const o=r[3];if(e.method==="GET")try{return{status:200,body:this.database.getOne(a,o,n),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(e.method==="PUT")try{return e.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOne(a,o,e.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(e.method==="PATCH")try{return e.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOne(a,o,e.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(e.method==="DELETE")try{return{status:200,body:this.database.removeOne(a,o),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}}else{if(e.method==="GET"){if(!this.database.getCollection(a))return{status:404,headers:{}};const o=this.database.getCount(a,n.filter?{filter:n.filter}:{});if(o>0){const c=this.database.getAll(a,n),l=n.range?n.range[0]:0,u=n.range&&n.range.length===2?Math.min(c.length-1+l,n.range[1]):c.length-1;return{status:c.length===o?200:206,body:c,headers:{"Content-Type":"application/json","Content-Range":`items ${l}-${u}/${o}`}}}return{status:200,body:[],headers:{"Content-Type":"application/json","Content-Range":"items */0"}}}if(e.method==="POST"){if(e.requestBody==null)return{status:400,headers:{}};const o=this.database.addOne(a,e.requestBody),c=`${this.baseUrl}/${a}/${o[this.database.getCollection(a).identifierName]}`;return{status:201,body:o,headers:{"Content-Type":"application/json",Location:c}}}}return{status:404,headers:{}}}addMiddleware(e){this.middlewares.push(e)}addCollection(e,r){this.database.addCollection(e,r)}getCollection(e){return this.database.getCollection(e)}getCollectionNames(){return this.database.getCollectionNames()}addSingle(e,r){this.database.addSingle(e,r)}getSingle(e){return this.database.getSingle(e)}getSingleNames(){return this.database.getSingleNames()}}function qt(t){if(!t)return{};const e={};return t.split("&").map(a=>{if(a.indexOf("=")===-1)e[a]=!0;else{let[n,s]=a.split("=");(s.indexOf("[")===0||s.indexOf("{")===0)&&(s=JSON.parse(s)),e[n.trim()]=s}}),e}class Te{constructor({loggingEnabled:e=!1,server:r,...a}={}){y(this,"loggingEnabled",!1);y(this,"server");this.server=r||new k(a),this.loggingEnabled=e}getHandler(){return async e=>{e.readyState=4;const r=this.getNormalizedRequest(e),a=await this.server.handle(r);this.respond(a,e)}}getNormalizedRequest(e){const r=typeof e=="string"?new Request(e):e,a=r.url?decodeURIComponent(r.url.slice(r.url.indexOf("?")+1)):"",n=qt(a);let s;if(r.requestBody)try{s=JSON.parse(r.requestBody)}catch{}return{url:r.url,headers:new Headers(e.requestHeaders),params:n,requestBody:s,method:r.method}}respond(e,r){const a={status:e.status,body:e.body??"",headers:e.headers??{}};Array.isArray(a.headers)?a.headers.find(n=>n.name.toLowerCase()==="content-type")||a.headers.push({name:"Content-Type",value:"application/json"}):a.headers["Content-Type"]||(a.headers["Content-Type"]="application/json"),r.readyState=1,r.respond(a.status,a.headers,JSON.stringify(a.body)),this.log(r,a)}log(e,r){this.loggingEnabled&&(console.group?(console.groupCollapsed(e.method,e.url,"(FakeRest)"),console.group("request"),console.log(e.method,e.url),console.log("headers",e.requestHeaders),console.log("body   ",e.requestBody),console.groupEnd(),console.group("response",r.status),console.log("headers",r.headers),console.log("body   ",r.body),console.groupEnd(),console.groupEnd()):(console.log("FakeRest request ",e.method,e.url,"headers",e.requestHeaders,"body",e.requestBody),console.log("FakeRest response",r.status,"headers",r.headers,"body",r.body)))}toggleLogging(){this.loggingEnabled=!this.loggingEnabled}}const Wd=t=>new Te(t).getHandler(),Yd=Te;class Oe{constructor({loggingEnabled:e=!1,server:r,...a}={}){y(this,"loggingEnabled",!1);y(this,"server");this.server=r||new k(a),this.loggingEnabled=e}getHandler(){return async(r,a)=>{const n=new Request(r,a),s=await this.getNormalizedRequest(n),i=await this.server.handle(s);return this.log(n,i,s),i}}async getNormalizedRequest(e){const r=typeof e=="string"?new Request(e):e,a=r.url?decodeURIComponent(r.url.slice(r.url.indexOf("?")+1)):"",n=qt(a),s=await r.text();let i;try{i=JSON.parse(s)}catch{}return{url:r.url,headers:r.headers,params:n,requestBody:i,method:r.method}}log(e,r,a){this.loggingEnabled&&(console.group?(console.groupCollapsed(a.method,a.url,"(FakeRest)"),console.group("request"),console.log(a.method,a.url),console.log("headers",e.headers),console.log("body   ",e.requestJson),console.groupEnd(),console.group("response",r.status),console.log("headers",r.headers),console.log("body   ",r.body),console.groupEnd(),console.groupEnd()):(console.log("FakeRest request ",a.method,a.url,"headers",e.headers,"body",e.requestJson),console.log("FakeRest response",r.status,"headers",r.headers,"body",r.body)))}toggleLogging(){this.loggingEnabled=!this.loggingEnabled}}const Xd=t=>new Oe(t).getHandler(),Zd=Oe;class zt{constructor({server:e,...r}){y(this,"server");this.server=e||new k(r)}getHandler(){return async({request:e})=>{const r=await this.getNormalizedRequest(e),a=await this.server.handle(r);return new Response(JSON.stringify(a.body),{status:a.status,headers:a.headers})}}async getNormalizedRequest(e){const r=new URL(e.url),a=Object.fromEntries(Array.from(new URLSearchParams(r.search).entries()).map(([s,i])=>[s,JSON.parse(i)]));let n;try{const s=await e.text();n=JSON.parse(s)}catch{}return{url:e.url,headers:e.headers,params:a,requestBody:n,method:e.method}}}const kd=t=>new zt(t).getHandler(),eh=t=>(e,r)=>new Promise(a=>{setTimeout(()=>{a(r(e))},t)});p.Collection=we,p.Database=Ht,p.FetchMockAdapter=Oe,p.FetchServer=Zd,p.MswAdapter=zt,p.Server=Yd,p.SimpleRestServer=k,p.Single=Kt,p.SinonAdapter=Te,p.getFetchMockHandler=Xd,p.getMswHandler=kd,p.getSinonHandler=Wd,p.withDelay=eh,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=fakerest.min.umd.cjs.map
